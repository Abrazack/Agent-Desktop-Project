<!DOCTYPE html>
<html lang="en" data-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Management Pro</title>
    <style>
        /* CSS remains the same */
    </style>
</head>
<body>
    <!-- Login System -->
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <h2 data-localize="welcome">Mhappy Online Store</h2>
            <form id="loginForm" onsubmit="event.preventDefault(); login()">
                <div class="form-group">
                    <label data-localize="username">Username</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label data-localize="password">Password</label>
                    <input type="password" id="password" required>
                </div>
                <button class="action-button success" data-localize="login">Login</button>
            </form>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="hidden">
        <!-- Header Section -->
        <div class="header">
            <h1 data-localize="business_dashboard">Business Dashboard</h1>
            <div>
                <span data-localize="logged_in_as">Logged in as: </span>
                <span id="currentUser"></span>
                <button class="action-button" onclick="showSettings()" data-localize="settings">‚öôÔ∏è Settings</button>
            </div>
        </div>

        <!-- Navigation Menu -->
        <nav class="nav-menu">
            <button class="nav-button" data-section="employees">Employees</button>
            <button class="nav-button" data-section="inventory">Inventory</button>
            <button class="nav-button" data-section="sales">Sales</button>
            <button class="nav-button" data-section="reports">Reports</button>
        </nav>

        <!-- Main Content -->
        <main class="container">
            <!-- Sections remain the same -->
        </main>

        <!-- Settings Modal -->
        <div class="modal" id="settingsModal">
            <div class="modal-content">
                <h3 data-localize="system_settings">System Settings</h3>
                <div class="settings-tabs">
                    <button class="action-button" onclick="showSettingsTab('user')">Users</button>
                    <button class="action-button" onclick="showSettingsTab('security')">Security</button>
                    <button class="action-button" onclick="showSettingsTab('localization')">Localization</button>
                </div>

                <!-- Settings tabs content remains the same -->
            </div>
        </div>
    </div>

    <script>
        // Improved System Configuration
        const SYSTEM_CONFIG = {
            exchangeRates: { USD: 1, EUR: 0.93, JPY: 148.5 },
            currentUser: null,
            users: JSON.parse(localStorage.getItem('users')) || [
                { username: 'admin', password: 'admin123', role: 'admin' }
            ],
            employees: JSON.parse(localStorage.getItem('employees')) || [],
            inventory: JSON.parse(localStorage.getItem('inventory')) || [],
            sales: JSON.parse(localStorage.getItem('sales')) || [],
            totalIncome: parseFloat(localStorage.getItem('totalIncome')) || 0,
            settings: JSON.parse(localStorage.getItem('settings')) || {
                language: 'en',
                currency: 'USD'
            },
            translations: {
                en: {
                    welcome: "Welcome to Mhappy Online Store",
                    username: "Username",
                    password: "Password",
                    login: "Login",
                    settings: "Settings",
                    name: "Name",
                    position: "Position",
                    salary: "Salary",
                    actions: "Actions",
                    add_employee: "Add Employee",
                    manage_employees: "Manage Employees"
                },
                es: { /* Spanish translations */ },
                fr: { /* French translations */ }
            }
        };

        // Initialization
        document.addEventListener('DOMContentLoaded', () => {
            applyLocalization();
            attachNavigationHandlers();
        });

        // Improved Login Function
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const user = SYSTEM_CONFIG.users.find(u => u.username === username && u.password === password);
            if(user) {
                SYSTEM_CONFIG.currentUser = user;
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('dashboard').classList.remove('hidden');
                document.getElementById('currentUser').textContent = user.username;
                updateUI();
                saveData();
            } else {
                alert('Invalid credentials');
            }
        }

        // Improved Employee Management
        function showEmployeeForm() {
            showModal('Add Employee', `
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="empName" required>
                </div>
                <div class="form-group">
                    <label>Position</label>
                    <input type="text" id="empPosition" required>
                </div>
                <div class="form-group">
                    <label>Salary</label>
                    <input type="number" id="empSalary" required>
                </div>
                <button class="action-button success" onclick="saveEmployee()">Save</button>
            `);
        }

        function saveEmployee() {
            const newEmployee = {
                id: Date.now(),
                name: document.getElementById('empName').value,
                position: document.getElementById('empPosition').value,
                salary: document.getElementById('empSalary').value
            };
            SYSTEM_CONFIG.employees.push(newEmployee);
            renderEmployees();
            closeModal();
            saveData();
        }

        // Improved Rendering
        function renderEmployees() {
            const tbody = document.getElementById('employeeList');
            tbody.innerHTML = SYSTEM_CONFIG.employees.map(emp => `
                <tr>
                    <td>${emp.name}</td>
                    <td>${emp.position}</td>
                    <td>${SYSTEM_CONFIG.settings.currency} ${emp.salary}</td>
                    <td>
                        <button class="action-button edit" onclick="editEmployee(${emp.id})">‚úèÔ∏è</button>
                        <button class="action-button delete" onclick="deleteEmployee(${emp.id})">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        function editEmployee(id) {
            const employee = SYSTEM_CONFIG.employees.find(e => e.id === id);
            showModal('Edit Employee', `
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="editName" value="${employee.name}" required>
                </div>
                <div class="form-group">
                    <label>Position</label>
                    <input type="text" id="editPosition" value="${employee.position}" required>
                </div>
                <div class="form-group">
                    <label>Salary</label>
                    <input type="number" id="editSalary" value="${employee.salary}" required>
                </div>
                <button class="action-button success" onclick="updateEmployee(${id})">Save</button>
            `);
        }

        function updateEmployee(id) {
            const employee = SYSTEM_CONFIG.employees.find(e => e.id === id);
            employee.name = document.getElementById('editName').value;
            employee.position = document.getElementById('editPosition').value;
            employee.salary = document.getElementById('editSalary').value;
            renderEmployees();
            closeModal();
            saveData();
        }

        function deleteEmployee(id) {
            SYSTEM_CONFIG.employees = SYSTEM_CONFIG.employees.filter(e => e.id !== id);
            renderEmployees();
            saveData();
        }

        // Improved Settings
        function showSettingsTab(tabName) {
            document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.add('hidden'));
            document.getElementById(`${tabName}Settings`).classList.remove('hidden');
        }

        // Improved Password Management
        function checkPasswordStrength(password) {
            const strength = Math.min(Math.floor(password.length / 3), 3);
            const strengthBar = document.getElementById('passwordStrength');
            strengthBar.className = ['weak', 'medium', 'strong'][strength - 1] || 'weak';
            strengthBar.style.width = `${strength * 33}%`;
        }

        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            
            if (SYSTEM_CONFIG.currentUser.password === currentPassword) {
                SYSTEM_CONFIG.currentUser.password = newPassword;
                saveData();
                alert('Password changed successfully!');
            } else {
                alert('Current password is incorrect');
            }
        }

        // Improved Localization
        function updateLanguage(lang) {
            SYSTEM_CONFIG.settings.language = lang;
            applyLocalization();
            saveData();
        }

        function updateCurrency(currency) {
            SYSTEM_CONFIG.settings.currency = currency;
            updateUI();
            saveData();
        }

        // Data Management
        function saveData() {
            localStorage.setItem('users', JSON.stringify(SYSTEM_CONFIG.users));
            localStorage.setItem('employees', JSON.stringify(SYSTEM_CONFIG.employees));
            localStorage.setItem('inventory', JSON.stringify(SYSTEM_CONFIG.inventory));
            localStorage.setItem('sales', JSON.stringify(SYSTEM_CONFIG.sales));
            localStorage.setItem('settings', JSON.stringify(SYSTEM_CONFIG.settings));
        }

        // Navigation Handling
        function attachNavigationHandlers() {
            document.querySelectorAll('.nav-button').forEach(button => {
                button.addEventListener('click', () => {
                    const sectionId = button.dataset.section;
                    document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
                    document.getElementById(sectionId).classList.remove('hidden');
                });
            });
        }

        // Utility Functions
        function showModal(title, content) {
            const modal = document.getElementById('settingsModal');
            modal.querySelector('#modalTitle').textContent = title;
            modal.querySelector('#modalContent').innerHTML = content;
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        function updateUI() {
            renderEmployees();
            // Add other render functions here
            document.querySelectorAll('.currency-display').forEach(el => {
                el.textContent = `${SYSTEM_CONFIG.settings.currency} ${SYSTEM_CONFIG.totalIncome}`;
            });
        }
    </script>
</body>
</html>